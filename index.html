<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Forever Yours ‚Äì For My Love ‚ù§Ô∏è</title>
<style>
  :root{
    --pink:#ff5fa8; --deep:#ff2f86; --bg:#050507; --soft:#ffe6f1; --ok:#2ecc71; --bad:#ff5b6a;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:#fff;overflow:hidden}
  .screen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column}
  .hidden{display:none!important}
  .bg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:-2;filter:brightness(.65)}
  .center{display:flex;flex-direction:column;align-items:center;gap:14px;z-index:2;text-align:center;padding:16px}
  .heart{font-size:92px;cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent;animation:beat 1200ms ease-in-out infinite; text-shadow:0 10px 34px rgba(255,20,147,.25)}
  @keyframes beat{0%{transform:scale(1)}40%{transform:scale(1.18)}100%{transform:scale(1)}}
  .subtitle{color:#ffdbe9;text-shadow:0 2px 6px rgba(0,0,0,.6)}
  .field{display:flex;gap:8px;align-items:center;justify-content:center;flex-wrap:wrap}
  input[type=text]{padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.25);background:rgba(0,0,0,.35);color:#fff;min-width:240px;font-size:16px}
  button{padding:11px 18px;border-radius:12px;border:none;cursor:pointer;font-weight:700}
  .primary{background:var(--pink);color:#200}
  .ghost{background:transparent;border:1px solid rgba(255,255,255,.35);color:#eee}
  .big-yes{position:fixed;inset:auto 0 10vh 0;margin:auto;width:86vw;max-width:560px;height:74px;border-radius:18px;background:linear-gradient(180deg,var(--pink),var(--deep));color:#200;font-size:28px;font-weight:900;box-shadow:0 12px 40px rgba(255,20,147,.45);z-index:5;animation:bob 1.2s infinite ease-in-out}
  @keyframes bob{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
  .whisper{position:fixed;top:8%;left:50%;transform:translateX(-50%);font-size:18px;color:#ffd1e6;text-shadow:0 0 10px rgba(255,50,120,.6);opacity:.95}
  /* modal */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;z-index:10}
  .card{background:#fff;color:#111;width:92vw;max-width:440px;border-radius:16px;padding:18px 16px;box-shadow:0 18px 50px rgba(0,0,0,.45);text-align:center}
  .card h3{margin:6px 0 4px}
  .card p{margin:10px 0 0}
  .error{color:#c62828;min-height:18px;font-size:14px;margin-top:6px}
  /* quiz */
  #quiz .title{font-size:26px;margin-bottom:8px;text-shadow:0 2px 10px rgba(0,0,0,.5)}
  .chips{display:grid;grid-template-columns:repeat(2, minmax(140px,1fr));gap:10px;width:92vw;max-width:720px}
  .chip{padding:10px 12px;border:1px solid rgba(255,255,255,.28);border-radius:12px;background:rgba(0,0,0,.35);backdrop-filter: blur(2px);cursor:pointer;text-align:center;transition:transform .2s, background .2s, border .2s}
  .chip.good.selected{background:rgba(46, 204, 113, .2); border-color:var(--ok)}
  .chip.bad{border-color:rgba(255,91,106,.5)}
  .chip.removed{opacity:0; transform:scale(.8); transition: all .25s ease}
  .hint{font-size:14px;opacity:.85;margin-top:10px}
  /* pick screen */
  .grid6{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;width:94vw;max-width:840px}
  .tile{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.22);border-radius:12px;overflow:hidden;position:relative;cursor:pointer}
  .tile img{width:100%;height:28vh;object-fit:cover}
  .tile .label{position:absolute;left:8px;bottom:8px;background:rgba(0,0,0,.6);padding:6px 10px;border-radius:10px;font-weight:700}
  .shake{animation:shake .35s}
  @keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-6px)}80%{transform:translateX(6px)}}
  /* final */
  #final-type{font-size:34px;color:var(--pink);text-shadow:0 0 16px rgba(255,20,147,.5);text-align:center}
  #teddy{position:absolute;left:-30%;bottom:8vh;width:160px;max-width:28vw;transition:left .8s ease, transform .25s ease}
  #rose{position:absolute;bottom:8vh;left:50%;transform:translateX(-50%);width:110px;display:none}
  .float-emoji{position:fixed;pointer-events:none;z-index:99}
  .center-card { background: rgba(0,0,0,0.45); padding:18px; border-radius:12px; }
  @media(min-width:900px){.heart{font-size:112px} #final-type{font-size:46px}}
</style>
</head>
<body>

<audio id="bgm" src="ava_ja.mp3" preload="auto" loop></audio>

<!-- START -->
<section id="start" class="screen">
  <img src="ava.jpg" alt="" class="bg" id="bg-start">
  <div class="center">
    <div class="center-card">
      <div class="heart" id="heart">‚ù§Ô∏è</div>
      <div class="subtitle">Jaan ho na aap meri?</div>
      <div class="field" style="margin-top:10px">
        <input id="answer" type="text" placeholder="Type: Yes / Ha / Hnn ..." autocomplete="off">
        <button class="primary" id="ansBtn">Submit</button>
      </div>
      <div id="tease" class="subtitle" style="min-height:22px;margin-top:8px;"></div>
    </div>
  </div>
  <button id="bigYes" class="big-yes hidden">YES üíó</button>
</section>

<!-- FULL NAME TRICK -->
<div id="nameModal" class="modal hidden" role="dialog" aria-modal="true">
  <div class="card">
    <h3>Enter your full name</h3>
    <p>For security reasons üòâ</p>
    <div class="field" style="margin-top:8px">
      <input id="fullname" type="text" placeholder="Your full name"/>
      <button id="nameBtn" class="primary">Continue</button>
    </div>
    <p id="nameHint" class="hint"></p>
    <p id="nameError" class="error"></p>
  </div>
</div>

<!-- QUIZ -->
<section id="quiz" class="screen hidden">
  <img src="ava.jpg" class="bg" alt="">
  <div class="center">
    <div class="center-card" style="max-width:900px">
      <div class="title">Why are you so amazing?</div>
      <div class="chips" id="chips"></div>
      <div class="hint">Pick **good** qualities (at least 5) to continue. Wrong ones will fade with ‚ÄúNope‚Äù üòâ</div>
      <button id="toPick" class="primary hidden" style="margin-top:10px">Continue</button>
    </div>
  </div>
</section>

<!-- PICK ‚Äì WORLD COMP -->
<section id="pick" class="screen hidden">
  <img src="bva.jpg" class="bg" alt="">
  <div class="center">
    <div class="center-card" style="width:100%;max-width:960px">
      <div class="title">‚ÄúNuman should marry whom in this World Competition?‚Äù</div>
      <div class="grid6" id="grid6"></div>
    </div>
  </div>
</section>

<!-- FINAL -->
<section id="final" class="screen hidden">
  <img src="bva.jpg" class="bg" alt="">
  <div class="center">
    <div class="center-card" style="max-width:900px">
      <div id="final-type"></div>
    </div>
  </div>
  <img id="teddy" src="teddy.png" alt="teddy">
  <img id="rose" src="rose.png" alt="rose">
</section>

<script>
/* ===== Helpers / Utilities ===== */
const byId = id => document.getElementById(id);
const bgm = byId('bgm');

function startMusicIfNeeded(){
  if (bgm && bgm.paused) {
    bgm.play().catch(()=>{ /* autoplay blocked until user gesture - handled by start interactions */ });
    bgm.volume = 0.55;
  }
}

function floatBurst(chars=['üíñ','üå∏'], n=24, dur=2200){
  for(let i=0;i<n;i++){
    const s = document.createElement('div');
    s.className='float-emoji';
    s.textContent = chars[Math.floor(Math.random()*chars.length)];
    s.style.left = (5+Math.random()*90)+'vw';
    s.style.top  = (55+Math.random()*40)+'vh';
    s.style.fontSize = (16+Math.random()*30)+'px';
    document.body.appendChild(s);
    const dy = 120 + Math.random()*240;
    s.animate([{transform:'translateY(0) scale(1)',opacity:1},{transform:`translateY(-${dy}px) scale(${1+Math.random()*0.6})`,opacity:0}],{duration:dur,easing:'cubic-bezier(.22,.9,.17,1)'});
    setTimeout(()=>s.remove(), dur+40);
  }
}

/* ===== START SCREEN ===== */
const heart = byId('heart');
const answer = byId('answer');
const ansBtn = byId('ansBtn');
const tease = byId('tease');
const bigYes = byId('bigYes');

const YES_WORDS = ['yes','ha','haan','han','hn','hnn','haa','y','yesh','yeah','ya'];
let resistClicks = 0;
function isYes(txt){ return YES_WORDS.includes((txt||'').trim().toLowerCase()); }

function nudgeHeart() {
  resistClicks++;
  tease.textContent = ["What?","Why üò¢","I thought you loved me ;("][(resistClicks-1)%3];
  const dx = (Math.random()>.5?1:-1)*(40+Math.random()*120);
  const dy = (Math.random()>.5?1:-1)*(20+Math.random()*70);
  heart.style.transform = `translate(${dx}px, ${dy}px) scale(1.05)`;
  setTimeout(()=> heart.style.transform = '', 450);
  if (resistClicks >= 3) bigYes.classList.remove('hidden');
}

function openNameModal() {
  startMusicIfNeeded();
  byId('nameModal').classList.remove('hidden');
}

ansBtn.addEventListener('click', ()=>{
  const v = answer.value;
  if (isYes(v)) {
    openNameModal();
  } else {
    nudgeHeart();
  }
});
heart.addEventListener('click', ()=> {
  startMusicIfNeeded();
  const v = answer.value;
  if (isYes(v)) openNameModal();
  else nudgeHeart();
});
bigYes.addEventListener('click', ()=>{
  answer.value = 'Yes';
  openNameModal();
});
document.addEventListener('pointerdown', function onFirst(){
  startMusicIfNeeded();
  document.removeEventListener('pointerdown', onFirst);
});

/* ===== FULL NAME TRICK (FIXED & robust) ===== */
const nameModal = byId('nameModal');
const fullname  = byId('fullname');
const nameBtn   = byId('nameBtn');
const nameHint  = byId('nameHint');
const nameError = byId('nameError');
let nameAttempts = 0;

function normalizeName(s){
  return (s || '').trim().replace(/\s+/g,' ').toLowerCase();
}

nameBtn.addEventListener('click', ()=>{
  const val = normalizeName(fullname.value);
  nameAttempts++;
  // accepted canonical normalized value:
  if (val === 'shaheen hassan') {
    nameModal.classList.add('hidden');
    goQuiz();
  } else {
    if (nameAttempts >= 2){
      nameHint.textContent = 'Maybe try Shaheen with my last name ;)';
    }
    nameError.textContent = "Hmm‚Ä¶ that doesn't look right.";
  }
});
fullname.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') nameBtn.click(); });

/* ===== QUIZ (15 options: 9 good, 6 bad) ===== */
const quiz = byId('quiz');
const chipsWrap = byId('chips');
const toPick = byId('toPick');

const GOOD = [
  'Your smile üíï','Your kindness ‚ú®','Your magic with food üç≤','Your caring heart üíó',
  'Your intelligence üß†','Your look üòç','Your laughter üé∂','Your patience üåπ','The way you love me üíû'
];
const BAD = [
  'Your pets üêü','Being lazy üõãÔ∏è','Mood swings üå©Ô∏è','Overthinking ü§Ø','Getting angry üò†','Forgetfulness üòÖ'
];

function goQuiz(){
  byId('start').classList.add('hidden');
  quiz.classList.remove('hidden');
  chipsWrap.innerHTML='';
  const makeChip = (text, good=true)=>{
    const d = document.createElement('div');
    d.className = 'chip '+(good?'good':'bad');
    d.textContent = text;
    d.dataset.good = good?'1':'0';
    d.addEventListener('click', ()=>{
      if (d.dataset.good==='1'){
        d.classList.toggle('selected');
        evalQuizProgress();
      } else {
        d.textContent = (Math.random()>0.5?'Nope ‚ùå':'Whoops üòú');
        d.classList.add('removed');
        setTimeout(()=> d.remove(), 260);
      }
    });
    return d;
  };
  // render shuffled
  const arr = [...GOOD.map(t=>({t,g:true})), ...BAD.map(t=>({t,g:false}))].sort(()=>Math.random()-0.5);
  arr.forEach(o=> chipsWrap.appendChild(makeChip(o.t,o.g)));
}

function evalQuizProgress(){
  const selected = [...document.querySelectorAll('.chip.good.selected')].length;
  if (selected >= 5){ // unlock at 5 or more
    toPick.classList.remove('hidden');
  } else {
    toPick.classList.add('hidden');
  }
}

toPick.addEventListener('click', ()=>{
  quiz.classList.add('hidden');
  showPick();
});

/* ===== PICK SCREEN (use 6 PNG images from your repo) ===== */
const pick = byId('pick');
const grid6 = byId('grid6');

function showPick(){
  pick.classList.remove('hidden');
  grid6.innerHTML = '';
  // tiles with actual image files (shuffle)
  const tiles = [
    {src:'bva.jpg', label:'Her (Winner) üíñ', good:true},
    {src:'duck.png', label:'A Duck', good:false},
    {src:'gulzar.png', label:'Gulzar', good:false},
    {src:'gabbar.png', label:'Gabbar', good:false},
    {src:'anjana.png', label:'Anjana Om Kashyap', good:false},
    {src:'random.png', label:'A Random Cat', good:false}
  ].sort(()=>Math.random()-0.5);

  tiles.forEach(t=>{
    const tile = document.createElement('div');
    tile.className = 'tile';
    const img = document.createElement('img');
    img.src = t.src;
    img.alt = t.label;
    tile.appendChild(img);
    const lab = document.createElement('div');
    lab.className='label';
    lab.textContent = t.label;
    tile.appendChild(lab);

    tile.addEventListener('click', ()=>{
      if (t.good){
        floatBurst(['üíñ','‚ú®','üå∏'], 30, 1600);
        setTimeout(()=> { pick.classList.add('hidden'); showFinal(); }, 650);
      } else {
        tile.classList.remove('shake'); void tile.offsetWidth;
        tile.classList.add('shake');
      }
    });
    grid6.appendChild(tile);
  });
}

/* ===== FINAL SCREEN with Teddy & Rose ===== */
const final = byId('final');
const finalType = byId('final-type');
const teddy = byId('teddy');
const rose = byId('rose');

function showFinal(){
  final.classList.remove('hidden');
  // teddy walks in (animate left to center)
  setTimeout(()=> { teddy.style.left='50%'; teddy.style.transform='translateX(-50%)'; }, 40);
  // small bursts
  floatBurst(['üíñ','üå∏','‚ú®'], 22, 2000);
  // typewriter
  typeWriter(finalType, "Always yours & I Love You Forever üíñ ‚Äì Numan", 60);
  // teddy reacts + offers rose after taps
  let taps=0;
  const teddyClick = ()=> {
    taps++;
    teddy.style.transform='translateX(-50%) scale(1.06)';
    setTimeout(()=> teddy.style.transform='translateX(-50%)', 220);
    if (taps>=2){
      rose.style.display='block';
    }
  };
  // ensure only one listener
  teddy.removeEventListener('click', teddyClick);
  teddy.addEventListener('click', teddyClick);
}

function typeWriter(el, text, speed=80, done){
  el.textContent=''; let i=0;
  const t = setInterval(()=>{
    el.textContent += text[i] || '';
    i++;
    if (i>text.length){ clearInterval(t); if(done) done(); }
  }, speed);
}

/* ===== Safety / small polish ===== */
window.addEventListener('error', e=> console.log('Error:', e.message));
console.log('Love app ready. Tap the heart to begin.');

/* ===== Allow Enter key for name input and answer input ===== */
answer.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') ansBtn.click(); });
fullname.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') nameBtn.click(); });

</script>
</body>
</html>
